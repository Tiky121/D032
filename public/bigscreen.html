<!DOCTYPE html>
<html lang="sk">
<head>
    <title>Big Screen</title>
    <link rel="stylesheet" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
</head>
<body>
    <div id="start-overlay" class="start-overlay"><button class="btn-primary" onclick="startBS()">START</button></div>
    <div class="video-wrapper"><video id="screenVideo" autoplay playsinline style="width:100%;height:100%;object-fit:contain;"></video></div>

    <script>
        const socket = io('/');
        const peerConfig = {
            host: '0.peerjs.com', port: 443, secure: true, debug: 2,
            config: { 'iceServers': [
                { urls: 'stun:stun.l.google.com:19302' },
                { urls: "turn:openrelay.metered.ca:80", username: "openrelayproject", credential: "openrelayproject" },
                { urls: "turn:openrelay.metered.ca:443", username: "openrelayproject", credential: "openrelayproject" },
                { urls: "turn:openrelay.metered.ca:443?transport=tcp", username: "openrelayproject", credential: "openrelayproject" }
            ]}
        };

        function startBS() {
            document.getElementById('start-overlay').style.display = 'none';
            const peer = new Peer(peerConfig);
            
            peer.on('open', (id) => {
                console.log("BigScreen ID: " + id);
                socket.emit('register-bigscreen', id);
            });

            peer.on('call', call => {
                call.answer();
                call.on('stream', s => {
                    document.getElementById('screenVideo').srcObject = s;
                });
            });
        }
    </script>
</body>
</html>