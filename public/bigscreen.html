<!DOCTYPE html>
<html lang="sk">
<head>
    <title>Big Screen</title>
    <link rel="stylesheet" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
</head>
<body>
    <div id="start-overlay" class="start-overlay">
        <button class="btn-primary" onclick="startBigScreen()">AKTIVOVA≈§ PREZENT√ÅCIU</button>
    </div>
    
    <div class="video-wrapper" style="background: #0f1014; flex-direction: column;">
        <!-- Logo alebo text keƒè sa nezdieƒæa -->
        <div id="waiting-text" style="text-align:center; color: var(--text-secondary);">
            <div style="font-size: 4rem; margin-bottom: 20px;">üì∫</div>
            <h2>Pripraven√© na zdieƒæanie</h2>
        </div>
        
        <video id="screenVideo" autoplay playsinline style="display:none;"></video>
    </div>

    <script>
        function startBigScreen() {
            document.getElementById('start-overlay').style.display = 'none';
            const peer = new Peer('big-screen', {
                host: location.hostname,
                port: location.port || (location.protocol === 'https:' ? 443 : 3000),
                path: '/peerjs',
                secure: (location.protocol === 'https:')
            });
            
            peer.on('call', call => {
                call.answer(); 
                call.on('stream', stream => {
                    document.getElementById('screenVideo').srcObject = stream;
                    document.getElementById('screenVideo').style.display = 'block';
                    document.getElementById('waiting-text').style.display = 'none';
                    
                    // Ak zdieƒæanie skonƒç√≠ (stream inactive)
                    stream.getVideoTracks()[0].onended = () => {
                        document.getElementById('screenVideo').style.display = 'none';
                        document.getElementById('waiting-text').style.display = 'block';
                    };
                });
            });
        }
    </script>
</body>
</html>