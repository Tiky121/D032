<!DOCTYPE html>
<html lang="sk">
<head>
    <title>Big Screen UMIKT</title>
    <link rel="stylesheet" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>
</head>
<body>
    <div id="start-overlay">
        <button class="btn-primary" onclick="startBS()">SPUSTIŤ PREZENTÁCIU</button>
    </div>

    <div class="wrapper">
        <div id="placeholder">
            <img src="logo.svg" alt="UMIKT" class="logo-img" style="opacity: 0.8;">
            <div id="waiting-text">Pripravené na zdieľanie obrazovky</div>
        </div>
        <video id="screenVideo" autoplay playsinline style="display:none;"></video>
    </div>

    <script>
        const socket = io('/');
        const peerConfig = {
            host: '0.peerjs.com', port: 443, secure: true,
            config: { iceTransportPolicy: 'all', 'iceServers': [{ urls: 'stun:stun.l.google.com:19302' }] }
        };

        function startBS() {
            document.getElementById('start-overlay').style.display = 'none';
            const peer = new Peer(peerConfig);
            peer.on('open', id => socket.emit('register-bigscreen', id));
            peer.on('call', call => {
                call.answer();
                call.on('stream', s => {
                    document.getElementById('placeholder').style.display = 'none';
                    const v = document.getElementById('screenVideo');
                    v.style.display = 'block'; v.srcObject = s;
                });
            });
            socket.on('stopped-sharing', () => {
                const v = document.getElementById('screenVideo');
                v.srcObject = null; v.style.display = 'none';
                document.getElementById('placeholder').style.display = 'flex';
            });
        }
    </script>
</body>
</html>